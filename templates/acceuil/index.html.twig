{% extends "template.html.twig" %}
{% block title %}Statistiques par Département
{% endblock title %}
{% block body %}
	<div style="display:flex;justify-content:center;align-items:center">
	
		<div style="width: 50%;height: 350px;">
			<canvas id="departmentVisitsChart"></canvas>
		</div>
		<div class="chart-container" style="width: 50%;height: 400px;">
			<canvas id="statistiquesChart"></canvas>
		</div>
	</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
	const data = {
labels: [{% for department, count in statisticsByDepartment %}'{{ department }}',{% endfor %}],
datasets: [
{
label: 'Nombre de Visites',
data: [{% for department, count in statisticsByDepartment %}{{ count }},{% endfor %}],
backgroundColor: [
'blue',
'yellow',
'orange',
'violet',
'rgba(205, 192, 192, 0.7)'
],
borderColor: 'rgb(75, 192, 192)',
borderWidth: 1
}
]
};

const config = {
type: 'pie',
data: data,
options: {
responsive: true,
scales: {
y: {
beginAtZero: true
}
}
}
};

const departmentVisitsChart = new Chart(document.getElementById('departmentVisitsChart'), config);
</script>
{# <div class="chart-container" style="width: 700px;height: 400px;">
			<canvas id="employeeChart"></canvas>
		</div> #}


<script>
	const employeeChart = document.getElementById('employeeChart').getContext('2d');
new Chart(employeeChart, {
type: 'pie',
data: {
labels: {{ employeeNames | raw }},
datasets: [
{
label: 'Nombre total de visites',
data: {{ visitCounts | raw }},
backgroundColor: [
'rgb(255, 99, 132)',
'rgb(54, 162, 235)',
'rgb(255, 205, 86)',
'#ace1af',
'violet',
'#89cff0'
],
borderColor: 'rgba(75, 192, 192, 1)',
borderWidth: 1
}
]
},
options: {
scales: {
y: {
beginAtZero: true
}
}
}
});
</script>

<script>
	const ctx = document.getElementById('statistiquesChart').getContext('2d');
const statistiques = {{ statistiques|json_encode|raw }};

new Chart(ctx, {
type: 'bar',
data: {
labels: Object.keys(statistiques),
datasets: [
{
label: 'Nombre de Visites',
data: Object.values(statistiques),
backgroundColor: [
      'rgba(255, 99, 132, 0.6)',
      'rgba(255, 159, 64, 0.6)',
      'rgba(255, 205, 86, 0.6)',
      'rgba(75, 192, 192, 0.6)',
      'rgba(54, 162, 235, 0.6)',
      'rgba(153, 102, 255, 0.6)',
      'rgba(201, 203, 207, 0.6)',
	  'rgb(255, 99, 132)',
      'rgb(255, 159, 64)',
      'rgb(255, 205, 86)',
      'rgb(75, 192, 192)',
      'rgb(54, 162, 235)',
	  'rgb(255, 99, 132)',
    ],
borderColor: 'rgba(75, 192, 192, 1)',
borderWidth: 1
}
]
},
options: {
scales: {
y: {
beginAtZero: true
}
}
}
});
</script>{% endblock %}{#     <h1>Tableau de bord</h1>
							
							    <p>Mois: {{ mois }}</p>
							    <p>Année: {{ annee }}</p>
							    <p>Nombre total de visites: {{ visites }}</p>
							
							    <h2>Visites par jour:</h2>
							    <ul>
							        {% for day, count in visitsPerDay %}
							            <li>{{ day }}: {{ count }} visites</li>
							        {% endfor %}
							    </ul>
							
							    <h2>Liste des employés:</h2>
							    <ul>
							        {% for employe in employes %}
							            <li>{{ employe.nom }} {{ employe.prenoms }}</li>
							        {% endfor %}
							    </ul>
							{% endblock %}
							
							
							{% block body %}
							
								<div>
									<canvas id="myChart"></canvas>
								</div>
							
								<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
							
								<script>
									const ctx = document.getElementById('myChart');
							new Chart(ctx, {
							type: 'bar',
							data: {
							labels: [
							'Janvier',
							'Février',
							'Mars',
							'Avril',
							'Mai',
							'Juin',
							'Juillet',
							'Aout',
							'Septembre',
							'Octobre',
							'Novembre',
							'Décembre'
							],
							datasets: [
							{
							label: '# visites',
							data: [
							12,
							19,
							3,
							5,
							2,
							3,
							0,
							45,
							10,
							3,
							1,
							0
							],
							borderWidth: 1
							}
							]
							},
							options: {
							scales: {
							y: {
							beginAtZero: true
							}
							}
							}
							});
								</script>
							{% endblock %} #}{# {% for employe in employes %}
											<div class="container-fluid px-4">
												<h1 class="mt-4">Tableau de bord de l'employe
													{{employe.nom}}
													{{employe.prenoms}}</h1>
												<ol class="breadcrumb mb-4">
													<li class="breadcrumb-item active">Tableau de bord</li>
												</ol>
												<div class="row">
													<div class="col-xl-3 col-md-6 mb-4">
														<div class="card border-left-primary shadow h-100 py-2">
															<div class="card-body">
																<div class="row no-gutters align-items-center">
																	<div class="col mr-2">
																		<div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
																			Visites effectuées</div>
																		<div class="h5 mb-0 font-weight-bold text-gray-800">{{employe.nombreVisitesEffectuées}}</div>
																	</div>
																	<div class="col-auto">
																		<i class="fas fa-calendar fa-2x text-gray-300"></i>
																	</div>
																</div>
															</div>
														</div>
													</div>
													<!-- Earnings (Monthly) Card Example -->
													<div class="col-xl-3 col-md-6 mb-4">
														<div class="card border-left-success shadow h-100 py-2">
															<div class="card-body">
																<div class="row no-gutters align-items-center">
																	<div class="col mr-2">
																		<div class="text-xs font-weight-bold text-success text-uppercase mb-1">
																			Visites recues</div>
																		<div class="h5 mb-0 font-weight-bold text-gray-800">{{employe.nombreVisitesRecues}}</div>
																	</div>
																	<div class="col-auto">
																		<i class="fa-solid fa-people-group fa-2x text-gray-300"></i>
																	</div>
																</div>
															</div>
														</div>
													</div>
									
													<!-- Earnings (Monthly) Card Example -->
													<div class="col-xl-3 col-md-6 mb-4">
														<div class="card border-left-info shadow h-100 py-2">
															<div class="card-body">
																<div class="row no-gutters align-items-center">
																	<div class="col mr-2">
																		<div class="text-xs font-weight-bold text-info text-uppercase mb-1">Visites crées
																		</div>
																		<div class="row no-gutters align-items-center">
																			<div class="col-auto">
																				<div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">50%</div>
																			</div>
																			<div class="col">
																				<div class="progress progress-sm mr-2">
																					<div class="progress-bar bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
																				</div>
																			</div>
																		</div>
																	</div>
																	<div class="col-auto">
																		<i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div>
												<!-- Pending Requests Card Example -->
												<div class="col-xl-3 col-md-6 mb-4">
													<div class="card border-left-warning shadow h-100 py-2">
														<div class="card-body">
															<div class="row no-gutters align-items-center">
																<div class="col mr-2">
																	<div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
																		Visites refusées</div>
																	<div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
																</div>
																<div class="col-auto">
																	<i class="fas fa-comments fa-2x text-gray-300"></i>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										{% endfor %} #}{# <script>
									document.addEventListener('DOMContentLoaded', function () {
							var ctx = document.getElementById('myChart').getContext('2d');
							var myChart = new Chart(ctx, {
							type: 'bar',
							data: {
							labels: [
							'Jan',
							'Feb',
							'Mar',
							'Apr',
							'May',
							'Jun',
							'Jul',
							'Aug',
							'Sep',
							'Oct',
							'Nov',
							'Dec'
							],
							datasets: [
							{
							label: 'Visits per Month',
							data: [
							12,
							19,
							3,
							5,
							2,
							3,
							7,
							8,
							10,
							6,
							8,
							15
							],
							backgroundColor: 'rgba(75, 192, 192, 0.6)',
							borderColor: 'rgba(75, 192, 192, 1)',
							borderWidth: 1
							}
							]
							},
							options: {
							scales: {
							y: {
							beginAtZero: true
							}
							}
							}
							});
							});
								</script> #}
